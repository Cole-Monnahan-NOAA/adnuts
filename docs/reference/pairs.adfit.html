<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Plot pairwise parameter posteriors and optionally the MLE points and confidence ellipses. — pairs.adfit • adnuts</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><link href="../extra.css" rel="stylesheet"><meta property="og:title" content="Plot pairwise parameter posteriors and optionally the MLE points and confidence ellipses. — pairs.adfit"><meta name="description" content="Plot pairwise parameter posteriors and optionally the MLE points and
confidence ellipses."><meta property="og:description" content="Plot pairwise parameter posteriors and optionally the MLE points and
confidence ellipses."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">adnuts</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.1.2.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../articles/adnuts.html">Get started</a></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/NUTS-for-ADMB-models.html">NUTS for ADMB models</a></li>
    <li><a class="dropdown-item" href="../articles/SNUTS-for-TMB-models.html">Sparse NUTS for TMB models</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/Cole-Monnahan-NOAA/adnuts/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Plot pairwise parameter posteriors and optionally the MLE points and confidence ellipses.</h1>
      <small class="dont-index">Source: <a href="https://github.com/Cole-Monnahan-NOAA/adnuts/blob/HEAD/R/pairs.R" class="external-link"><code>R/pairs.R</code></a></small>
      <div class="d-none name"><code>pairs.adfit.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Plot pairwise parameter posteriors and optionally the MLE points and
confidence ellipses.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="co"># S3 method for class 'adfit'</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/pairs.html" class="external-link">pairs</a></span><span class="op">(</span></span>
<span>  <span class="va">x</span>,</span>
<span>  pars <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  order <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"orig"</span>, <span class="st">"slow"</span>, <span class="st">"fast"</span>, <span class="st">"mismatch"</span>, <span class="st">"cor"</span><span class="op">)</span>,</span>
<span>  inc_warmup <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  diag <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"trace"</span>, <span class="st">"acf"</span>, <span class="st">"hist"</span><span class="op">)</span>,</span>
<span>  acf.ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1</span>, <span class="fl">1</span><span class="op">)</span>,</span>
<span>  ymult <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  axis.col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grDevices/gray.html" class="external-link">gray</a></span><span class="op">(</span><span class="fl">0.5</span><span class="op">)</span>,</span>
<span>  label.cex <span class="op">=</span> <span class="fl">0.8</span>,</span>
<span>  limits <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  add.mle <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  add.monitor <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  add.inits <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  unbounded <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-pars">pars<a class="anchor" aria-label="anchor" href="#arg-pars"></a></dt>
<dd><p>A character vector of parameters or integers
representing which parameters to subset. Useful if the model
has a larger number of parameters and you just want to show
a few key ones.</p></dd>


<dt id="arg-order">order<a class="anchor" aria-label="anchor" href="#arg-order"></a></dt>
<dd><p>The order to consider the parameters. Options are
'orig' (default) to use the order declared in the model, or
'slow' and 'fast' which are based on the effective sample
sizes ordered by slowest or fastest mixing
respectively. 'mismatch' sorts by parameters with
large discrepancies between the MLE and posterior marginal
variances, defined as the absolute relative difference of
the MLE from the posterior i.e., abs((mle-post)/post).
Finally, 'cor' orders by the largest maximum absolute
pairwise posterior correlation (including lp__).
See example for usage.</p></dd>


<dt id="arg-inc-warmup">inc_warmup<a class="anchor" aria-label="anchor" href="#arg-inc-warmup"></a></dt>
<dd><p>Whether to include the warmup samples or not
(default).</p></dd>


<dt id="arg-diag">diag<a class="anchor" aria-label="anchor" href="#arg-diag"></a></dt>
<dd><p>What type of plot to include on the diagonal,
options are 'acf' which plots the autocorrelation function
<code>acf</code>, 'hist' shows marginal posterior histograms, and
'trace' the trace plot.</p></dd>


<dt id="arg-acf-ylim">acf.ylim<a class="anchor" aria-label="anchor" href="#arg-acf-ylim"></a></dt>
<dd><p>If using the acf function on the diagonal,
specify the y limit. The default is c(-1,1).</p></dd>


<dt id="arg-ymult">ymult<a class="anchor" aria-label="anchor" href="#arg-ymult"></a></dt>
<dd><p>A vector of length ncol(posterior) specifying how
much room to give when using the hist option for the
diagonal. For use if the label is blocking part of the
plot. The default is 1.3 for all parameters.</p></dd>


<dt id="arg-axis-col">axis.col<a class="anchor" aria-label="anchor" href="#arg-axis-col"></a></dt>
<dd><p>Color of axes</p></dd>


<dt id="arg-label-cex">label.cex<a class="anchor" aria-label="anchor" href="#arg-label-cex"></a></dt>
<dd><p>Control size of outer and diagonal labels
(default 1)</p></dd>


<dt id="arg-limits">limits<a class="anchor" aria-label="anchor" href="#arg-limits"></a></dt>
<dd><p>A list containing the ranges for each parameter
to use in plotting.</p></dd>


<dt id="arg-add-mle">add.mle<a class="anchor" aria-label="anchor" href="#arg-add-mle"></a></dt>
<dd><p>Boolean whether to add 95% confidence ellipses</p></dd>


<dt id="arg-add-monitor">add.monitor<a class="anchor" aria-label="anchor" href="#arg-add-monitor"></a></dt>
<dd><p>Boolean whether to print effective sample</p></dd>


<dt id="arg-add-inits">add.inits<a class="anchor" aria-label="anchor" href="#arg-add-inits"></a></dt>
<dd><p>Boolean whether to add the initial values to the plot</p></dd>


<dt id="arg-unbounded">unbounded<a class="anchor" aria-label="anchor" href="#arg-unbounded"></a></dt>
<dd><p>Whether to use the bounded or unbounded
version of the parameters.  size (ESS) and Rhat values on
the diagonal.</p></dd>


<dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>Arguments to be passed to plot call in lower
triangular panels (scatterplots).</p></dd>


<dt id="arg-fit">fit<a class="anchor" aria-label="anchor" href="#arg-fit"></a></dt>
<dd><p>A list as returned by <code>sample_nuts</code>.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>Produces a plot, and returns nothing.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>This function is modified from the base <code>pairs</code>
  code to work specifically with fits from the 'adnuts'
  package using either the NUTS or RWM MCMC algorithms. If an
  invertible Hessian was found (in <code>fit$mle</code>) then
  estimated covariances are available to compare and added
  automatically (red ellipses). Likewise, a "monitor" object
  from <code><a href="https://mc-stan.org/rstan/reference/monitor.html" class="external-link">rstan::monitor</a></code> is attached as <code>fit$monitor</code>
  and provides effective sample sizes (ESS) and Rhat
  values. The ESS are used to potentially order the parameters
  via argument <code>order</code>, but also printed on the diagonal.</p>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Cole Monnahan</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="va">fit</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/readRDS.html" class="external-link">readRDS</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">'examples'</span>, <span class="st">'fit.RDS'</span>, package<span class="op">=</span><span class="st">'adnuts'</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/pairs.html" class="external-link">pairs</a></span><span class="op">(</span><span class="va">fit</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="pairs.adfit-1.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/pairs.html" class="external-link">pairs</a></span><span class="op">(</span><span class="va">fit</span>, pars<span class="op">=</span><span class="fl">1</span><span class="op">:</span><span class="fl">2</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="pairs.adfit-2.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/pairs.html" class="external-link">pairs</a></span><span class="op">(</span><span class="va">fit</span>, pars<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">1</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="pairs.adfit-3.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/pairs.html" class="external-link">pairs</a></span><span class="op">(</span><span class="va">fit</span>, pars<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'b'</span>, <span class="st">'a'</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/pairs.html" class="external-link">pairs</a></span><span class="op">(</span><span class="va">fit</span>, pars<span class="op">=</span><span class="fl">1</span><span class="op">:</span><span class="fl">2</span>, order<span class="op">=</span><span class="st">'slow'</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="pairs.adfit-4.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/pairs.html" class="external-link">pairs</a></span><span class="op">(</span><span class="va">fit</span>, pars<span class="op">=</span><span class="fl">1</span><span class="op">:</span><span class="fl">2</span>, order<span class="op">=</span><span class="st">'fast'</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="pairs.adfit-5.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/pairs.html" class="external-link">pairs</a></span><span class="op">(</span><span class="va">fit</span>, pars<span class="op">=</span><span class="fl">1</span><span class="op">:</span><span class="fl">2</span>, order<span class="op">=</span><span class="st">'mismatch'</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Cole Monnahan.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer></div>





  </body></html>

